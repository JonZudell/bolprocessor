2007-03-23	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/Dialogs.c (BPSetDialogAppearance):
		Only change font size on OS X; use size 11.
	
	* source/BP2/Inits.c (SetupWindow):
		Set initial font size for text windows using TextSize().  (This seems
			to fix the issues with incorrect font size & TextEdit on OS X).
	
	* source/BP2/SaveLoads3.c (NewFile & OldFile):
		Set AlertOn to true before opening Nav. Serv. dialogs to avoid the
			Resume/Stop dialog appearing.

2007-03-22	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/NavServWrapper.c (SimpleNavServEventProc):
	* source/BP2/SaveLoads3.c (PutFileEventProc):
		Call BP's DoEvent() when an update event occurs in Nav. Serv. dialogs.

	* source/BP2/-BP2.proto.h:
	* source/BP2/SaveLoads3.c (OpenTemp & OpenTrace):
		Abstracted out similarities of these two functions into 
			CreateTempFileInLocalDirectory().
		Delete BP2.trace if it exists when OpenTrace() is called.

	* source/BP2/SaveLoads1.c (LoadSettings):
		Don't change window size or text size when FreezeWindows is true.
	
	* scripts/+sc.checkall:  Wrapped script with 'Freeze windows ON/OFF'.

2007-03-21	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/Inits.c (SetupWindow):
	* source/BP2/Interface1.c (SetViewRect):
		On OS X, do not leave extra space at bottom of window for non-existent
			horizontal scroll bar.  (TextEdit doesn't outline the view Rect).
	
	* source/BP2/-BP2.proto.h:
	* source/BP2/Inits.c (SetupWindow):
	* source/BP2/Dialogs.c (BPSetDialogAppearance):
		Set theme background for all dialogs and set font size of all controls
			for better appearance on OS X.

2007-03-19	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/Csound.c (FixCsoundScoreName):
		Csound doesn't care if score filename ends with ".sco".
	
	* source/BP2/-BP2decl.h:
	* source/BP2/-BP2main.h:
		FileName[], CsFileName, MIDIfileName, & CsoundOrchestraName strings 
			should be MAXNAME+1 in length instead of MAXNAME.
	
	* source/BP2/CsoundScoreMake.c:
	* source/BP2/MenuCommands.c:
	* source/BP2/MIDIfiles.c:
	* source/BP2/SaveLoads1.c:
	* source/BP2/SaveLoads2.c:
	* source/BP2/SaveLoads3.c:
	* source/BP2/ScriptUtils.c:
	* source/BP2/Translit.c:
		Changed all instances of MyPtoCstr() that were copying a filename to
			p2cstrcpy() instead because the former changes some whitespace
			characters.  (Checked that this would not cause buffer overflows).
	
	* source/BP2/ScriptUtils.c:
		Prevented a buffer overflow in script command "Open file" when the
			filename was too long.

	* source/BP2/SaveLoads3.c (CheckFileName):
		Revised to not require filename prefixes.
		Don't ask when changing filename.
		Temporarily turn off ScriptExecOn to confirm wrong filetype.

2007-03-16	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/SaveLoads1.c:
	* source/BP2/SaveLoads2.c:
		Setting Created[w] whenever a file is loaded into a window that changes
			its title.
	
	* source/BP2/MenuCommands.c (mOpenFile):
		Allow opening any file in Data window with Option key.
		Change prompts to use DocumentTypeName[] instead of FilePrefix[].
		Use IdentifyBPFileType() instead of checking for prefixes.
		Set Weird[] when loading files with conflicting prefix or extension,
			but don't change the filename.
		Copy filenames without changing any characters (MyPtoCstr changes them).
		
	* source/BP2/Interface1.c (PutFirstLine):
		When adding filenames to windows, include prefix + ":" before any
			name that does not start with the correct prefix.

	* source/BP2/Misc.c:
		Abstracted out the similarities between all Get*Name() functions
			into new function GetLinkedFileName().
		GetLinkedFileName() checks for ":" after the prefix in file links
			and strips the prefix if found, thus reversing the "encoding"
			performed by PutFirstLine().

2007-03-15	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/-BP2decl.h:
	* source/BP2/-BP2main.h:
		New array DocumentTypeName[].
	
	* source/BP2/Interface2.c (DoSystem):
		Commented out erroneous use of MemError().

	* source/BP2/MenuCommands.c (mLoadProject):
		Use IdentifyBPFileType() instead of checking for prefixes.
			
2007-03-14	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/-BP2.h:
		Added wUnknown & iDecisions to window/file indices.
		Added FileTypeIndex enumeration that corresponds to constants being
			used elsewhere.
	
	* source/BP2/-BP2decl.h:
	* source/BP2/-BP2main.h:
		Array to map from FileTypeIndex to window/file indices.
	
	* source/BP2/-BP2.proto.h:
	* source/BP2/SaveLoads3.c:
		New function IdentifyBPFileType() and friends that determine BP2
			document type by examining filetype/creator, prefix, and filename
			extension.

	* source/BP2/AppleEvents.c (MyHandleODOC):
		Use IdentifyBPFileType() instead of only checking filename prefix
			to determine how to open files via AEs.

2007-03-13	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/CoreMIDIdriver.c:
		Check for NULL return from CFSTR().
		#include <CoreFoundation/CFString.h>
	
	* source/BP2/MenuCommands.c:
		Show CMSettings dialog when checking MIDI input.
		
	* BP2-MacOS.cw8.mcp:
		Linking to CoreFoundation framework solves CFSTR crash.
		Replace SIOUX library in Mach-O build with 	console_OS_X.c.

	* source/BP2/-BP2decl.h:
	* source/BP2/-BP2main.h:
		New constant string array FileExtension[WMAX] for file extensions.

	* resources/plst-resource.plc:  Minor changes to file extensions.
			
	* source/BP2/-BP2.proto.h:
	* source/BP2/SaveLoads1.c:
	* source/BP2/SaveLoads2.c:
	* source/BP2/SaveLoads3.c:
		Suggested names when saving now include "untitled"; on OS X, BP2
			suggests new file extensions instead of the prefixes.
	
	* source/BP2/AppleEvents.c:
		Minor changes to displaying errors for ODOC event.
		Don't refuse to open files without '-' or '+' at beginning of name.
	
	* BP2 help:  Updated Types-Creators section with file extension info.
	
2007-03-09	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/-BP2.proto.h:
	* source/BP2/MenuCommands.c:
	* source/BP2/Processes.c:
		Implemented the menu command for launching Audio MIDI Setup on OS X.

2007-03-07	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/SaveLoads3.c (NewFile & OldFile):
		Set arrow cursor before opening standard file dialogs.

	* resources/CoreMIDISettings.rsrc:  Hide unused check buttons for now.

2007-03-06	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/CoreMIDIdriver.c:
		Clarify logic for CoreMIDIOutputOn & CoreMIDIInputOn.
	
	* source/BP2/CarbonCompatUtil.c:
	* source/BP2/CarbonCompatUtil.h:
		New functions for abstracting differences of TEToScrap on OS 9/X and
		for debugging scrap changes.
	
	* source/BP2/MenuCommands.c (mCut, mCopy, mPaste, et al):
		Attempting to fix Cut/Copy/Paste so that they will work correctly on
		OS X without breaking them on OS 9.  Not sure yet if this succeeds ...
	
	
2007-03-05	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/-BP2.proto.h:
	* source/BP2/Dialogs.c:
	* source/BP2/BP2main.c:
		Minor fixes for non-Mach-O builds.
	
	* BP2-MacOS.cw8.mcp:  Revised link order for better locality of references.
	
	* source/BP2/SaveLoads1.c (LoadDecisions):
		Don't report an error when user cancels in the Open file dialog.
	
	* source/BP2/MenuCommands.c (mSendMIDI):
	* source/BP2/MIDIfiles.c (ReadMIDIfile):
		Return without continuing when user cancels the Open file dialog.
	
	* source/BP2/Inits.c (Inits): Always allow ResetMIDIFilter() to be called.
	
	* source/BP2/MIDIstuff.c (AllNotesOffAllChannels):
		Removed incorrect use of #if USE_BUILT_IN_MIDI_DRIVER so that All
		Notes Off now works with all drivers.
	
2007-03-01	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/CoreMIDIdriver.c:
		Now reads selections from list boxes in CoreMIDI settings dialog and
			sends and receives from multiple sources & destinations.  Keeps
			arrays of active MIDIEndpointRefs separate from the CMListData
			structs for fast processing.
	
	* source/BP2/-BP2.proto.h:
	* source/BP2/-BP2decl.h:
	* source/BP2/Dialogs.c:
	* source/BP2/MenuCommands.c:
	* source/BP2/CoreMIDIdriver.c:
		Handles events in CM settings dialog.

2007-02-28	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/CoreMIDIdriver.c:
		Implemented "intelligent" tracking of MIDI endpoints as they are 
			created and destroyed; now includes endpoints in lists that were
			available previously but went "offline" and shows their status to
			the user.
		List data structures support remembering multiple selections even
			when the endpoints change their order in the lists.
		Sorts lists of MIDI sources and destinations in the settings dialog.

2007-02-27	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/CoreMIDIdriver.c:
		Added pthread mutex for synchronization of the Midi input queue.
		Queue automatically increases in size on reset if it overflowed.
		FlushDriver() now flushes the input queue too.
	
2007-02-26	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/CoreMIDIdriver.c:
		Fixed queue overflow so that pQueueFront always points to the 
			beginning of a Midi event.
	
	* resources/plst-resource.plc:
		Added key CFBundleExecutable and document type information.
	
	* BP2-MacOS.cw8.mcp:
	* resources/MacOSFinderHelp.r:
	* resources/carb.r:
		Removed these CFM-only resources from the Mach-O build.  No longer
			displays the "launch in Classic" option in OS X Finder.

	* resources/CoreMIDISettings.rsrc:
		Added a copy of the Devices MENU resource with new CoreMIDI items.
		This file must come before BP2-MacOS.rsrc in the link order.

	* source/BP2/-BP2main.h:
	* source/BP2/-BP2.proto.h:
	* source/BP2/MenuCommands.c:
	* source/BP2/CoreMIDIdriver.c:
		New items 'CoreMIDI Settings' and 'Open Audio MIDI Setup' in the
			Devices menu for the Mach-O build only.
	
2007-02-23	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* resources/CoreMIDISettings.rsrc:
		New file with dialog resources for CoreMIDI settings.
	
	* source/BP2/CoreMIDIdriver.c:
	* source/BP2/Inits.c (MakeWindows): 
	* source/BP2/-BP2.proto.h:
	* BP2-MacOS.cw8.mcp:
		Code for creating and updating CoreMIDI settings dialog.
	
2007-02-22	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/-BP2.h:
	* source/BP2/-BP2decl.h:
	* source/BP2/-BP2main.h:
	* source/BP2/BP2main.c (RegisterMidiDrivers, etc.):
	* source/BP2/Inits.c (Inits): 
		New code for dynamically adding drivers and Devices menu items.
			(unfinished).

2007-02-21	Anthony Kozar	<anthonykozar@sbcglobal.net>
	
	* source/BP2/CoreMIDIdriver.c:
	* source/BP2/-BP2.proto.h:  Implemented MIDI input with CoreMIDI.

	* source/BP2/MenuCommands.c (mMIDIinputcheck & mMIDIoutputcheck):
		Commented out incorrect messages about null driver (need to change more).

2007-02-20	Anthony Kozar	<anthonykozar@sbcglobal.net>
	
	* source/BP2/CoreMIDIdriver.c:
		Improved error checking after all CoreMIDI and CF calls.
	
	* source/BP2/MenuCommands.c (mAbout):
		Stop About box from activating the wrong window (EXPERIMENTAL).
	
	* source/BP2/Inits.c (MakeWindows): 
	* source/BP2/Interface2.c (ShowMessage & FlashInfo):
		Call QDFlushPortBuffer so that welcome window and messages will be
			drawn before update events are received on OS X.
	
2007-02-19	Anthony Kozar	<anthonykozar@sbcglobal.net>
	
	* icons/BP2-OSX-appl.icns:
	* icons/BP2-OSX-icon.pict:
	* icons/BP2-OSX-icon.psd:
	* resouces/plst-resource.plc:
		New files with OS X application icon (will redesign later).
	
	* BP2-MacOS.cw8.mcp:  Output plist as a file for Mach-O target.
	
	* source/BP2/CoreMIDIdriver.c:
		(FlushDriver) Call MIDIFlushOutput().
		(SetDriver) Set MaxMIDIbytes so that BP schedules all events early.
	
	* source/BP2/Misc.c:
	* source/BP2/Dialogs.c:
	* source/BP2/Interface1.c:
	* source/BP2/Interface2.c:
	* source/BP2/-BP2.proto.h:
		Fixed bug where DisplayHelp() would modify constant strings.  Now
			takes a const parameter and must call FilterHelpSelector()
			before hand if passing a string created at runtime.

	* source/BP2/NavServWrapper.h (NSWInitReply):
		Need to initialize isHTML and isText members of NSWReply.
	
	## Trial changes using the EXPERIMENTAL macro ##
	
	* source/BP2/GetRelease.c (ResetProject):  Avoid writing to Scrap window.
	
	* source/BP2/Interface1.c (DoEvents & BPActivateWindow):
		Numerous changes to basic event handling to try to solve oddities
			with window dragging, handling of content clicks, and to remove
			redundant code. 
	
2007-02-16	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/CoreMIDIdriver.c:
		(DriverWrite) Fixed integer overflow while calculating timestamps.
		(Get/SetDriverTime) Changed to use CoreAudio hosttime clock.

2007-02-15	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/CoreMIDIdriver.c:
	* BP2-MacOS.cw8.mcp:
		New file with driver code to use CoreMIDI for the Mach-O/OS X build.
	
	* source/BP2/-BP2.proto.h:
	* source/BP2/MIDIdrivers.c:
	* source/BP2/MIDIstuff.c (CaptureMidiEvent & RegisterProgramChange):
		Factored out code from DriverWrite() that needs to be shared.

	* source/BP2/BP2main.c (main):  Call InitCoreMidiDriver() on OS X.

	* source/BP2/MIDIstuff.c (SendToDriver):
		Only use running status with built-in serial driver.

2007-02-14	Anthony Kozar	<anthonykozar@sbcglobal.net>
	
	* source/BP2/Interface1.c:
	* source/BP2/BP2main.c:
		Make sure that BP quits on OS X.
		
	* source/BP2/MIDIstubs.c (GetDriverTime & SetDriverTime):
		Use TickCount() to keep accurate time so that waiting for the end of a
			performance will work.
	
2007-02-13	Anthony Kozar	<anthonykozar@sbcglobal.net>
	
	* BP2-MacOS.cw8.mcp: New Mach-O target.

	* source/prefix/PrefixMachO.h:  New prefix header for Mach-O build.
	
	* source/BP2/NavServWrapper.h:  Fix headers for Mach-O.
	
2007-02-09	Anthony Kozar	<anthonykozar@sbcglobal.net>
	
	* source/BP2/Interface2.c:
		Changed Alert1() to write messages to Message window instead of 
			displaying an Alert box when Beta && ScriptExecOn are both true.
	
	* source/BP2/Interface1.c:
		Fixed TextEdit scroll position on window update bug by removing the call
			to SetViewRect() in UpdateWindow().
	
	* source/BP2/AppleEvents.c:
		Set Created[] to true when opening files via Apple Events so that 
			"Save" command will save to same location.
	
	* scripts/+sc.checkall:
		Commented out grammars that cause the error in FillPhaseDiagram for now.

2007-02-08	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/SaveLoads1.c (LoadMIDIorchestra):
		Fixed LoadOn not being decremented sometimes.
		Removed the requirement for an active Midi driver to load orchestra.
	
	* source/BP2/FillPhaseDiagram.c:
	* source/BP2/Interface1.c:
	* source/BP2/MenuCommands.c:
	* source/BP2/MIDIloads.c:
	* source/BP2/MIDIstuff.c:
	* source/BP2/Misc.c:
	* source/BP2/ProduceItems.c:
	* source/BP2/SaveLoads1.c:
	* source/BP2/Ticks.c:
	* source/BP2/TimeSet.c:
	* source/BP2/TimeSetFunctions.c:
	* source/BP2/Dialogs.c:
		Changed all checks for an active Midi driver (such as (!OMS &&
			!InBuiltDriverOn)) to use a new function IsMidiDriverOn().
	
	* source/BP2/-BP2.proto.h:
	* source/BP2/MIDIdrivers.c:
	* source/BP2/MIDIstubs.c:
		New function IsMidiDriverOn() with separate implementations for null
			driver and OMS/built-in driver code.

	* source/BP2/Dialogs.c:
		Prevented inescapable loop when using the "Import" button in the 
			Prototypes5 window and trying to cancel the operation.
	
	
2007-02-07	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/NavServWrapper.c:
	* source/BP2/NavServWrapper.h:
		New NSWGetFile() function to create Open file dialogs with Nav Services.
		
	* source/BP2/SaveLoads3.c (OldFile):
		Modified to use the NSWGetFile() function.
	
2007-02-06	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/-BP2.proto.h: New and changed functions in SaveLoads3.c.
	
	* source/BP2/CsoundScoreMake.c:
	* source/BP2/Inits.c:
	* source/BP2/MenuCommands.c:
	* source/BP2/MIDIfiles.c:
	* source/BP2/SaveLoads1.c:
	* source/BP2/SaveLoads2.c:
	* source/BP2/Translit.c:
		Added window index argument to NewFile() calls.
	
	* source/BP2/SaveLoads3.c (NewFile, CreateFile, etc.):
		String constants and code for adding Format menu items in Save dialog.
		Factored out some of the format/type logic to new functions.
		NewFile() chooses a single type to save for "opaque" documents or 
			makes a list of format choices for the editable text documents.
		CreateFile() either retrieves format choice from NSWReply (NavServices)
			or still displays button dialog (StdFile).
		Changed logic so that user is always presented with a choice of formats
			when doing a "Save As" on an appropriate document type.
		Added customized PutFileEventProc() callback routine for Nav Services.
		
	* source/BP2/NavServWrapper.c:
	* source/BP2/NavServWrapper.h:
		Customized NSWReply record for BP's use within event callback.
		Use event filter from SaveLoads3.c instead of simple NSW one.
		Fixed illegal access in event filter that crashed on OS X (this bug
			was from the Apple sample code in Nav. Services documentaion).
		Now passes the entire NSWReply as our callback user data to NavPutFile.
		Using align=68k to fix the StandardFileReply compatibility of NSWReply.

2007-02-02	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/SaveLoads1.c:
	* source/BP2/SaveLoads2.c:
	* source/BP2/SaveLoads3.c:
	* source/BP2/Translit.c:
		Revising file saving code to properly init & dispose of NSWReply records.

	* source/BP2/-BP2.proto.h:
	* source/BP2/NavServWrapper.c:
	* source/BP2/NavServWrapper.h:
	* source/BP2/SaveLoads3.c:
		Adding format popup-menu items to Save dialog.
	
	* source/BP2/Strings.c:
		Made first parameter of CopyPString() "const".
	
2007-02-01	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/-BP2.h:
	* source/BP2/-BP2.proto.h:
		Replaced StandardFileReply with NSWReply.
	
	* source/BP2/NavServWrapper.c:
	* source/BP2/NavServWrapper.h:
		Improvements to Navigation Services code.
	
	* source/BP2/-BP2decl.h:
	* source/BP2/-BP2main.h:
	* source/BP2/Inits.c:
		New globals MIDIfileReply & CsFileReply to save NSWReply's until the 
			files are closed.  (So we can call NavCompleteSave()).
	
	* source/BP2/CsoundScoreMake.c:
	* source/BP2/MIDIfiles.c:
	* source/BP2/MenuCommands.c:
		Revising file saving code to properly init & dispose of NSWReply records.

2007-01-31	Anthony Kozar	<anthonykozar@sbcglobal.net>
		
	* BP2-MacOS.cw8.mcp: Added NavServWrapper.c to all targets.

	* source/BP2/-BP2.h:
	* source/BP2/-BP2.proto.h:
	* source/BP2/CsoundScoreMake.c:
	* source/BP2/MenuCommands.c:
	* source/BP2/MIDIfiles.c:
	* source/BP2/NavServWrapper.h:
	* source/BP2/SaveLoads1.c:
	* source/BP2/SaveLoads2.c:
	* source/BP2/SaveLoads3.c:
	* source/BP2/Translit.c:
		Got rudimentary "Save As" functionality to work using Navigation Serv.

2007-01-30	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* resources/BP2-MacOS.rsrc:
	* source/BP2/-BP2.h:
		Conditionalized About alert depending on Carbon/WASTE/TextEdit.
		
	* resources/BP2-MacOS.rsrc:
		Changed dialog windows that were of the old "rounded corners" desk
			accessory type to Carbon-compliant WDEFs.
		Removed alert, dialog, menu, and window color table resources.
		
	* source/BP2/Inits.c (MakeWindows):
		Added Appearance call for Carbon to make dialogs use system colors.
	
	* source/BP2/MIDIstuff.c (ListenMIDI):
		Fixed infinite loop when Beta == true and no Midi.
	
2007-01-29	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/CarbonCompatUtil.c:
		Finished replacements for old Scrap Manager calls.
	
	* source/BP2/MenuCommands.c (mEnterFind):
		Don't add null char to scrap; fixed possible memory leak.

2007-01-26	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/BP2main.c:  Reconditionalizing driver closing calls.
		
	* source/BP2/MenuCommands.c:  Conditionalize out calls to FixPort().
	
	* source/BP2/SaveLoads1.c (SaveSettings & LoadSettings):
		Conditionalize OMS code.  Force OutMIDI & Oms false when not available.
	
	* source/BP2/MIDIdrivers.c:
	* source/BP2/MIDIstuff.c:
		Moved CheckMIDIbytes() to MIDIstuff.c since it is a "high-level" routine.
		
	* source/BP2/MIDIstubs.c:
		New functions to replace "high-level" MIDI interface in MIDIdrivers.c.

	* source/prefix/PrefixCarbonTextEdit.h:
		Set WITH_REAL_TIME_MIDI to enable the Null Midi driver on Carbon.
		
	** 12:44 PM EST -- Compiles and links with CarbonLib !! **

	* source/BP2/Inits.c (SetUpMenus):
		Don't add Apple menu items under Carbon.
		Remove Quit & separator from File menu on OS X.
	
	* resources/carb.r:
	* resources/plst-resource.plc:
		New files for 'carb' and 'plst' resources so that BP will launch 
			as a native OS X application.

	* BP2-MacOS.cw8.mcp:
		Updated Carbon targets for new files; configured Property List 
			Compiler settings.

2007-01-25	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/-BP2proto.h:
		Divided up MIDI functions prototypes based on driver availability and
			which ones are needed for any MIDI functionality.

2007-01-23	Anthony Kozar	<anthonykozar@sbcglobal.net>
(committed on 2007-01-25)
	
	* source/BP2/Inits.c (Inits):
		Replaced NewAEEventHandlerProc() with NewAEEventHandlerUPP().
	
	* source/BP2/AppleEvents.c:
		Added const qualifier to first parameter of all AEvent handlers.
	
	* source/BP2/Inits.c (Inits):
	* source/BP2/Interface1.c (DoContent):
		Moved allocation of ControlActionUPPs to Inits() to avoid memory leaks.
	
	* source/BP2/-BP2decl.h:
	* source/BP2/-BP2main.h:
		New globals (vScrollUPP & hScrollUPP) for scroll bar ControlActionUPPs.
	
	* source/BP2/MIDIdrivers.c:
	* source/BP2/MIDIstuff.c:
		Moved ResetMIDIFilter() from MidiDrivers.c to MIDIstuff.c.

	* source/BP2/MIDIstubs.c:
		Non-realtime replacement for GetDriverTime().
		
	* source/BP2/-BP2proto.h:
		Changes to RT Midi conditionalization.
	
	* source/BP2/Compute.c:
	* source/BP2/Dialogs.c:
	* source/BP2/Inits.c:
	* source/BP2/Interface1.c:
	* source/BP2/MakeSound.c:
	* source/BP2/MenuCommands.c:
	* source/BP2/MIDIloads.c:
	* source/BP2/MIDIstuff.c:
	* source/BP2/Misc.c:
	* source/BP2/Polymetric.c:
	* source/BP2/ProduceItems.c:
	* source/BP2/SaveLoads1.c:
	* source/BP2/Script.c:
	* source/BP2/ScriptUtils.c:
	* source/BP2/Ticks.c:
		Attempting to conditionalize out more real-time midi code.  This
			approach needs more thought though and I may reverse some of
			these changes.
	
2007-01-22	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/Inits.c:
	* source/BP2/Interface1.c:
		Replaced [Enable|Disable]Item() with [Enable|Disable]MenuItem() and
			CheckItem() with CheckMenuItem().
	
	* source/BP2/Script.c:
		Replaced CountMItems() with CountMenuItems().
		Fixed GetMenu() memory leak by using GetMenuHandle() instead.
		
	* source/BP2/-BP2.proto.h:
		Backwards compatibility macros for [Enable|Disable]MenuItem so that we
			don't have to require OS 8.5 for the non-Carbon build.
	
	* source/BP2/Misc.c (Date):	
		Replaced IUTimeString() with TimeString(); other calls OK.

	* source/BP2/SaveLoads3.c (NewFile & OldFile):
		Conditionalized opening & saving files on Carbon to fail until we
			can finish Navigation Services support.
	
	* source/BP2/NavServWrapper.[c|h]:
		New files that create a single API for Standard File Package & 
			Navigation Services (not done yet).
		
	* source/BP2/CarbonCompatUtil.[c|h]:
		New files for cross-API compatibility including Scrap Manager.
	
	* source/BP2/MenuCommands.c:
	* source/BP2/SaveLoads1.c:
	* source/BP2/SaveLoads2.c:
		Replaced ZeroScrap(), GetScrap(), and PutScrap() with new functions 
			in CarbonCompatUtil.c.

2007-01-19	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/-BP2.h:
	* source/BP2/Inits.c:
	* source/BP2/Print.c:
		Removed "Qd." macros and fixed the Transitional build.
	
	* source/BP2/BP2main.c (main):  Commented out NewGrowZoneProc() call.
	* source/BP2/BP2main.c (MyGrowZone):  Conditionalized for !__POWERPC.
	
	* source/BP2/Processes.c (CallUser): Commented out unused NM code.
	
	* source/BP2/-BP2.proto.h:
	* source/BP2/Inits.c:
	* source/BP2/Interface1.c:
	* source/BP2/MenuCommands.c:
		Conditionalizing more of the OMS code.
		
	* source/BP2/MIDIstubs.c:  New file with stubs for needed MIDI routines.
	
	* source/BP2/-BP2decl.h:
	* source/BP2/-BP2main.h:
	* source/BP2/Inits.c:
	* source/BP2/MIDIfiles.c:
	* source/BP2/ProduceItems.c:
	* source/BP2/SaveLoads3.c:
		Replaced FSDelete() with FSpDelete(), using FSMakeFSSpec() as needed.
		New global for saving MIDIfileSpec.

2007-01-18	Anthony Kozar	<anthonykozar@sbcglobal.net>

	* source/BP2/Color.c:
	* source/BP2/Graphic.c:
	* source/BP2/Inits.c:
	* source/BP2/Interface1.c:
	* source/BP2/Interface2.c:
	* source/BP2/MenuCommands.c:
	* source/BP2/Misc.c:
		Replaced InvalRect() with InvalWindowRect() and ValidRect() with 
			ValidWindowRect().

	* source/BP2/-BP2.proto.h:
		Backwards compatibility macros for [Inval|Valid]WindowRect so that we
			don't have to require OS 8.5 for the non-Carbon build.
	
	* source/BP2/Inits.c:  Reinstated MoreMasters() for non-Carbon build and
		conditionalized to MoreMasterPointers() for Carbon.
	
	* source/BP2/-BP2decl.h:
	* source/BP2/-BP2main.h:
	* source/BP2/Inits.c:  
		New global: RunningOnOSX; Moved GoodMachine() call near beginning of
			Inits() and it now checks whether we are on OS 8/9 or OS X.
	
	* source/BP2/-BP2.h:
	* source/BP2/BP2main.c:
	* source/BP2/Graphic.c:
	* source/BP2/Inits.c:
	* source/BP2/Interface1.c:
	* source/BP2/Interface2.c:
	* source/BP2/MakeSound.c:
	* source/BP2/MenuCommands.c:
	* source/BP2/MIDIstuff.c:
	* source/BP2/Print.c:
	* source/BP2/SaveLoads1.c:
		Converted QuickDraw globals to Carbon accessor functions.

2007-01-17	Anthony Kozar	<anthonykozar@sbcglobal.net>
	* source/BP2/Graphic.c:
	* source/BP2/TimeSet.c:
		Enabled SHOWEVERYTHING & DISPLAY_PHASE_DIAGRAM compile-time flags to
			be set externally.
	
	* source/BP2/-BP2.proto.h:
	* source/BP2/Strings.c:
	* source/BP2/Inits.c:
	* source/BP2/SaveLoads1.c:
	* source/BP2/SaveLoads2.c:
	* source/BP2/SaveLoads3.c:
		Replaced pStrCopy(char*,Str255) with CopyPString(Str255,Str255).
	
	* resources/BP2-MacOS.rsrc:
		Unset "System Heap" bit on affected resources.
		Changed version to 2.9.6 development.
		
	* resources/MacOSFinderHelp.r:
		New file to define 'kind' and Balloon help resources for OS 9 Finder.
	
	* source/BP2/MenuCommands.c:
	* source/BP2/Inits.c:
	* source/BP2/-BP2decl.h:
	* source/BP2/-BP2main.h:
		Conditionalized out printing on Carbon.
	
	* source/BP2/Inits.c:
	* source/BP2/Interface1.c:
	* source/BP2/Interface2.c:
	* source/BP2/Translit.c:
		Conditionalized SystemTask(), SystemClick(), and OpenDeskAcc() calls.
	
	* source/BP2/-BP2.h:
	* source/BP2/-BP2decl.h:
	* source/BP2/-BP2main.h:
	* source/BP2/GetRelease.c:
	* source/BP2/Inits.c:
	* source/BP2/Misc.c:
		More conditionalization of real-time MIDI & scheduler code.

2007-01-16	Anthony Kozar	<anthonykozar@sbcglobal.net>
	* source/BP2/-BP2.h:  Temporary fix for lack of StandardFile types.
	
	* source/BP2/AppleEvents.c:
	* source/BP2/Inits.c:
		Conditionalize out Edition Manager aevents.

	* source/BP2/-BP2.proto.h:
	* source/BP2/AppleEvents.c:
	* source/BP2/Color.c:
	* source/BP2/CsoundScoreMake.c:
	* source/BP2/Graphic.c:
	* source/BP2/Inits.c:
	* source/BP2/Interface1.c:
	* source/BP2/Interface2.c:
	* source/BP2/MakeSound.c:
	* source/BP2/MenuCommands.c:
	* source/BP2/MIDIfiles.c:
	* source/BP2/MIDIloads.c:
	* source/BP2/Misc.c:
	* source/BP2/Processes.c:
	* source/BP2/SaveLoads1.c:
	* source/BP2/SaveLoads2.c:
	* source/BP2/SaveLoads3.c:
	* source/BP2/Script.c:
	* source/BP2/ScriptUtils.c:
	* source/BP2/Strings.c:
	* source/BP2/Ticks.c:
	* source/BP2/Translit.c:
		Convert c2pstr() calls to Carbon-compatible equivalents.

2007-01-15	Anthony Kozar	<anthonykozar@sbcglobal.net>
	* source/BP2/BP2main.c:
	* source/BP2/WindowText.c:
		Minor fixes for compiling without WASTE.
	
	* BP2-MacOS.cw8.mcp: New targets for CarbonAccessors/TextEdit, Carbon/WASTE,
			and Carbon/TextEdit builds.
		
	* source/prefix/PrefixTransTextEdit.h:
	* source/prefix/PrefixTransWASTE.h:
	* source/prefix/PrefixCarbonTextEdit.h:
	* source/prefix/PrefixCarbonWASTE.h:
		New prefix files that set BP2 compile options for Transitional & 
		Carbon targets.

	* source/BP2/-BP2.h:
	* source/BP2/-BP2.proto.h:
	* source/BP2/-BP2decl.h:
	* source/BP2/-BP2main.h:
	* source/BP2/midi1.h:
		Added preprocessor "guards" for each file.
		Made it possible to set BP2 compile-time options in another file
			while retaining the default settings if undefined.
		Began to conditionalize for Carbon and no real-time MIDI.

	* source/BP2/Dialogs.c:
	* source/BP2/GetRelease.c:
	* source/BP2/Graphic.c:
	* source/BP2/Inits.c:
	* source/BP2/Interface1.c:
	* source/BP2/MIDIdrivers.c:
	* source/BP2/SaveLoads1.c:
		Removed unnecessary or dangerous casts to WindowPtr, DialogPtr, GrafPtr.

	* source/BP2/Inits.c:  Replaced LMGetMBarHeight with GetMBarHeight.
	
	* source/BP2/BP2main.c:
	* source/BP2/Inits.c:
		Began to conditionalize real-time MIDI code.
		Conditionalized some Toolbox calls in main() and Inits() that are
			obsolete in Carbon.

2007-01-13	Anthony Kozar	<anthonykozar@sbcglobal.net>
	* source/BP2/Interface1.c:
	* source/BP2/Interface2.c:
	* source/BP2/Inits.c:
		Converted for CarbonAccessors.

	* source/BP2/Print.c:
		Can't convert since OPAQUE_TOOLBOX_STRUCTS makes it impossible.
		Will need to completely replace this code for the real Carbon build.
		
2007-01-12	Anthony Kozar	<anthonykozar@sbcglobal.net>
	* source/BP2/Dialogs.c:
	* source/BP2/MenuCommands.c:
	* source/BP2/Misc.c:
		Replaced Window[wRandomSequence] with gpDialogs[wRandomSequence].
		Replaced Window[wFindReplace] with gpDialogs[wFindReplace].
		Replaced Window[wTickDialog] with gpDialogs[wTickDialog].
		Converted for CarbonAccessors.

	* source/BP2/Interface1.c:
		Partially converted for CarbonAccessors.
		
2007-01-10	Anthony Kozar	<anthonykozar@sbcglobal.net>
	* source/BP2/Arithmetic.c:
	* source/BP2/Automata.c:
	* source/BP2/CompileProcs.c:
	* source/BP2/CsoundMaths.c:
	* source/BP2/CsoundScoreMake.c:
	* source/BP2/DisplayThings.c:
	* source/BP2/FillPhaseDiagram.c:
	* source/BP2/Glossary.c:
	* source/BP2/HTML.c:
	* source/BP2/Interaction.c:
	* source/BP2/MIDIdrivers.c:
	* source/BP2/MIDIfiles.c:
	* source/BP2/MIDIstuff.c:
	* source/BP2/Processes.c:
	* source/BP2/ProduceItems.c:
	* source/BP2/SaveLoads2.c:
	* source/BP2/SaveLoads3.c:
	* source/BP2/Schedule.c:
	* source/BP2/ScriptAlgo.c:
	* source/BP2/ScriptUtils.c:
	* source/BP2/SetObjectFeatures.c:
	* source/BP2/SoundObjects1.c:
	* source/BP2/SoundObjects2.c:
	* source/BP2/SoundObjects3.c:
	* source/BP2/Strings.c:
	* source/BP2/Ticks.c:
	* source/BP2/TimeSet.c:
	* source/BP2/TimeSetFunctions.c:
	* source/BP2/Zouleb.c:
		Switched to CarbonAccessors (no conversion necessary).

	* source/BP2/AppleEvents.c:
	* source/BP2/Color.c:
	* source/BP2/CompileGrammar.c:
	* source/BP2/Compute.c:
	* source/BP2/Csound.c:
	* source/BP2/DisplayArg.c:
	* source/BP2/Encode.c:
	* source/BP2/GetRelease.c:
	* source/BP2/Graphic.c:
	* source/BP2/MakeSound.c:
	* source/BP2/MIDIloads.c:
	* source/BP2/OMS.c:
	* source/BP2/PlayThings.c:
	* source/BP2/Polymetric.c:
	* source/BP2/SaveLoads1.c:
	* source/BP2/Script.c:
	* source/BP2/Translit.c:
		Converted for CarbonAccessors.

	* source/BP2/WindowText.c: Partially converted for WASTE true.
	

2007-01-09	Anthony Kozar	<anthonykozar@sbcglobal.net>
	* source/BP2/BP2main.c: Converted for CarbonAccessors.
	
	* source/BP2/-BP2.h: Set BIGTEST and COMPILING_BETA to 1 for now.
	
	* source/BP2/-BP2decl.h:
	* source/BP2/-BP2main.h:
	* source/BP2/BP2main.c:
	* source/BP2/Dialogs.c:
	* source/BP2/GetRelease.c:
	* source/BP2/Inits.c:
	* source/BP2/Interface1.c:
	* source/BP2/Interface2.c:
	* source/BP2/Misc.c:
	* source/BP2/Strings.c:
	* source/BP2/Ticks.c:
		Modified to not allocate space for (most) windows and dialogs.
		Now using DialogPtrs everywhere instead of DialogRecords.
		Changed some WindowPtrs to DialogPtrs as appropriate.
		DRecord[] renamed to gpDialogs[].
		Duplicating pointers between Window[] and gpDialogs[] for now, but
			should be changed to be independent everywhere.

2007-01-08	Anthony Kozar	<anthonykozar@sbcglobal.net>
	* BP2-MacOS.cw8.mcp: New target for Carbon Transitional build.
	
	* (all files in source/BP2/ and source/WASTE):
		Added per file #includes for MacHeaders.h or MacHeadersTransitional.h
		
	* (all files in source/BP2/ and source/additional):
		Added copyright statement and license.
	
2007-01-05	Anthony Kozar	<anthonykozar@sbcglobal.net>
	* source/BP2/Inits.c:
	* source/BP2/Interface1.c:
		#ifdefed out CheckRegistration(), Y2K(), and MakeNewKeyFile().
		
	* BP2-MacOS.cw8.mcp: New project file for CodeWarrior pro 8.
	
	* (36 files in source/BP2/):
		Renamed ActivateWindow() to BPActivateWindow() and
		GetWindowIndex() to BPGetWindowIndex() and 
		FileType[] to gFileType[] to avoid conflicts with Univ. Headers 3.4.2.
		Everything now compiles with CodeWarrior 8 and UH 3.4.2.

2007-01-02	Anthony Kozar	<anthonykozar@sbcglobal.net>
	* VERSION 2.9.5 (FINAL)
	
	* BP2 help: Updated entries for "Where can I get the latest version of BP2?"
		and "Where can I find more information?"

	* BP2 help: Added entries for "License" and "free software".

	* resources/BP2-MacOS.rsrc: 
		Updated version resource & date in the about alert.
		Fixed coloring of menu items in the File menu.

	* source/BP2/-BP2.h:
	* source/BP2/-BP2main.h:
	* source/BP2/Inits.c:
		Added "BP2.9.5" to VersionName and updated IDSTRING, MAXVERSION, and
		Version defines/globals.
		New #define COMPILING_BETA to set Beta global.  (May move to prefix file).

	* source/BP2/BP2main.c (main): Commented out the call to Y2K().

2006-06-06	Anthony Kozar	<anthonykozar@sbcglobal.net>
	* source/BP2/BP2main.c (main):
	* source/BP2/MenuCommands.c (mAbout):
	* source/BP2/Dialogs.c (DoDialog):
		Disabled the registration system.  Modified "Register" buttons in 
		opening and about alerts so that they read "License" and display the
		"License.txt" file.  Disabled launching the Kagi "Register" app.
	
	* BP2 help: Updated FAQ entry for "How do I register for BP2?"
	
	* resources/BP2-MacOS.rsrc: Updated info in the about alert.

2006-06-05	Anthony Kozar	<anthonykozar@sbcglobal.net>
	* source/BP2/Strings.c (MystrcpyHandleToString):  Fixed a buffer overrun bug.

	* data/Thierry_Montaudon/-or.piano: Moved to data/Harm_Visser.

	* New ChangeLog file :)

2006-06-02	Anthony Kozar	<anthonykozar@sbcglobal.net>
	* Many more example files added to new directories:
		bolprocessor/data/Harm_Visser
		bolprocessor/data/Jerome_Demolliens
		bolprocessor/data/Thierry_Montaudon

	* New CVS module, QAVAID, containing the Prolog II code and projects
	  from Bernard that create grammars from sets of musical examples.
